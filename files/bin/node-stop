#!/bin/bash
#
# A simple wrapper to facilitate stopping an elixir node that was
# started with `node-start`
#
# Usage:
# node-stop
#

# exit if any any command fails
set -e

# establish the name and cookie (if available)
name="stop@$(hostname -i)"
cookie="${COOKIE:-nanobox}"
remote="${HOSTNAME//./-}@$(hostname -i)"

elixir \
  --name $name \
  --cookie $cookie \
  -e ":rpc.call(:\"$remote\", :init, :stop, [])"
